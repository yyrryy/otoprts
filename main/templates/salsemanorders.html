{% extends 'base.html' %}
{% block css %}
<style>
    
</style>
{% endblock %}
{% block content %}

{% if user.groups.all.0.name == 'salsemen' %}
<div class="mt-5">
  <div class="card">
    <div class="card-header d-flex justify-content-between">
      <h5>Order History</h5>
    </div>
    <div class="card-divider"></div>
    <div class="card-table">
      <div class="table-responsive-sm">
        <table class="table table-striped table-borded">
          <thead>
            <tr>
              <th>Date</th>
              <th>Client</th>
              <th>Total</th>
            </tr>
          </thead>
          <tbody>
            {% for order in orders %}
            <tr>
              <td>{{ order.date|date:"d/m/Y" }}</td>
              <td>{{ order.client }}</td>
              <td>{{ order.total}}</td>
            </tr>
            {% empty %}
            <tr>
              <td colspan="3">No orders yet</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
    <div class="card-divider"></div>

  </div>

</div>
{%endif%}
{% if user.groups.all.0.name == 'clients' %}
<div class="bg-white mt-2">



  <div class="row mb-5">
    
    <div class="col-6 fitscreen">
      <p class="card-header sticky-top">
        Commandes
      </p>
      <table class="table table-hover table-striped table-borded tablecommande">
        <thead>
          <tr>
            <th>Date</th>
            <th>Client</th>
            <th>Repr</th>
          </tr>
        </thead>
        <tbody>
          {% for order in orders %}
          <tr class="ord {% if order.isdelivered%}bg-primary{%endif%}" orderid="{{order.id}}">
            <td>{{ order.date|date:'d/m/Y' }}</td>
            <td>{{ order.client }}</td>
            <td>{{ order.salseman}}</td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <div class="col-6 fitscreen details orderitems position-relative">
      
    </div>

    
  </div>
  <hr>
  


</div>
{%endif%}
{% endblock %}
{% block js %}
<script>
  $('.ord').each(function(){
      $(this).click(function(){
        loading()
        
        id=$(this).attr('orderid');

            $.ajax({
                url: '/orderitems/'+id,
                type: 'POST',
                data:{
                  'csrfmiddlewaretoken': '{{ csrf_token }}',
                },
                success: function(data){
                  console.log($('.orderitems'))
                  $('.orderitems').html(data.data);
                  stoploading()
                  $('.closeorderitems').click(function(){
                    $('.orderitems').removeClass('openorder');
                  })
                }
            });
        });
    })
</script>
{% endblock %}