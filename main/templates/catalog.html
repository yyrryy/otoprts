{% extends 'base.html' %}
{% load static %}

{% block css %}
<style>
	.commandholder{
		transition: all .6s ease-in;
		z-index: 9999;
	}
	.opencommandholder{
		right: 0;
	}

	.closecommandholder{
		right: -99em;
	}
	
</style>
{% endblock %}
{% block content %}

<!-- add csfr token -->
{% csrf_token %}

	<!-- row with catalog and command divs -->
	<div>

		

		<div class="d-flex justify-content-between">
			<div class="fitscreen bg-white shadow rounded px-2" style="width: 57%;">
				<div class="bg-white p-2 sticky-top d-flex border-end rounded-top sticky-top  align-items-center">
				
					<!-- category filter -->
					<div class="d-flex col-8">
						<div class="col-7">
							<div class="filter-vehicle">
								<select name="category" id="" class="form-control form-control-select2">
									<option value="0">Category</option>
									{% for category in cc %}
										{% if category.has_promotion %}
										<option value="{{ category.id }}">{{ category.title }} (promotion)</option>
										{% else %}
										<option value="{{ category.id }}">{{ category.title }}</option>
										{% endif %}
									{% endfor %}
								</select>
								
							</div>
						</div>
						<!-- <button class="btn btn-primary btn-sm filterbtn">Filter</button>	 -->
					</div>
	
					<!-- search table input -->
					<div class="col-4">
						<input type="text" class="form-control" id="myInput" placeholder="Search" onkeyup="searchtable()">
					</div>
				</div>
				<table class="table table-striped table-hover table-bordered thistable" id="myTable">
					<thead>
						<tr>
						<th >#</th>
						<th >Name</th>
						<th>Prix</th>
						<th>Offre</th>
						<th>Min</th>
						<th style="width: 5%;">Qty</th>
						</tr>
					</thead>
					<tbody class="prdctslist">
						
					</tbody>
				</table>

			</div>

			<div class="col-5 fitscreen bg-white shadow rounded px-2">
				<div class="sticky-top card-header text-center d-flex justify-content-between align-items-center">
					<small>
						Commande
					</small>
					<!-- a button to clear commande -->
					<button class="btn clearcommande" onclick="clearcommande()">
						X
					</button>
				</div>
				
				<table class="table table-striped table-bordered table-hover">
					<thead>
					<tr>
						<th >ref</th>
						<th >article</th>
						<th style="width: 5%;">Qty</th>
						<th style="width: 5%;">total</th>
					</tr>
					</thead>
					<tbody class="commande-table">
						
					</tbody>
				</table>
				
			</div>
		</div>
		<!-- confirmation option 1 -->
		<!-- <div class="row mt-2  justify-content-end p-2">
			
			<div class=" col-5 d-flex justify-content-between">
				<div>
					TOTAL: <span class="total">0</span>
				</div>
				<button class="btn btn-primary" data-toggle="modal" data-target="#addclientmodal">Client
				</button>
			</div>
		
		</div> -->
		<div class=" mt-3  p-2 bg-white rpunded shadow d-flex justify-content-between align-items-center">
			<div>
				TOTAL: <span class="total">0</span>
			</div>

			<div class="d-flex justify-content-between modes border p-2">
				<!-- add a list od mod pyem -->
				<select class="form-select mb-2" aria-label="Default select example" name="modpymnt">
					<option selected value="0">Mode de payement</option>
					<option value="espece">Espece (-5%/article)</option>
					<option value="cheque">Cheque (delai 4 mois)</option>
				  </select>
			
			
				<!-- add a list od mod lvrs -->
			
				<select class="form-select mb-2" aria-label="Default select example" name="modlvrsn">
					<option selected value="0">Mode de livraison</option>
					<option value="lux">Lux</option>
					<option value="sdtm">SDTM</option>
					<option value="ghazala">Ghazala</option>
					<option value="baha">Baha express</option>
				  </select>
			</div>
			{% if user.groups.all.0.name == 'salsemen' %}
			<div class="col-4">
				<div class="d-flex justify-content-center">
					<select class="form-control form-control-select2 clientid" name="client" >
						<option value="0">---</option>
						{% for i in clients %}
							<option value="{{i.id}}">{{i.name}} ({{i.address}})</option>
						{% endfor %}
					</select>
					
					{% csrf_token %}
					<button class="btn btn-primary valider" disabled>
					Confirmer
					</button>
				</div>
				
				<button class="btn btn-primary w-100 mt-2" data-toggle="modal" data-target="#addclientmodal">
					<i class="bi bi-plus"></i>Nouveau client
				</button>

				<small class="text-danger d-none clienterr">
					Choisir un client ou ajouter un nouveau
				</small>
			</div>
				
			{% endif %}
			{% if user.groups.all.0.name == 'clients' %}
			<input type="hidden" class="clientid" value="{{user.client.id}}">
			<div>{{ request.user.client.name }}</div>
			<button class="btn btn-primary valider" disabled>confirmer</button>
			
			{% endif %}
			
		</div>
	</div>
	
	<!-- Button trigger modal -->

	<!-- Modal -->
  <div class="modal fade" id="addclientmodal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
	<div class="modal-dialog" role="document">
	  <div class="modal-content">
		<div class="modal-header">
		  <button type="button" class="close" data-dismiss="modal" aria-label="Close">
			<span aria-hidden="true">&times;</span>
		  </button>
		</div>
		<div class="modal-body">
			<div class="accordion mb-2" id="accordionExample">
				<div class="accordion-item">
				  <h2 class="accordion-header" id="headingOne">
					<button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne">
					  +Ajouter
					</button>
				  </h2>
				  <div id="collapseOne" class="accordion-collapse collapse show" aria-labelledby="headingOne" data-bs-parent="#accordionExample">
					<div class="accordion-body">
						<form id="addclientform">
							{% csrf_token %}
							<div class="form-group">
								<label for="exampleInputEmail1">Nom ou Nom commercial</label>
								<input name="name" type="text" required class="form-control">
							</div>
							
							<div class="form-group">
								<label for="exampleInputPassword1">Phone</label>
								<input name="phone" type="text" required class="form-control">
							</div>
							<div class="form-group">
								<label for="exampleInputPassword1">Ville</label>
								<input name="city" type="text" required class="form-control">
							</div>
							<div class="form-group">
								<label for="exampleInputPassword1">Addresse</label>
								<input name="address" type="text" required class="form-control">
							</div>
							<button  class="btn btn-primary addclientbtn w-100">Submit</button>
					  </form>
					</div>
				  </div>
				</div>
			</div>
			
		</div>
	  </div>
	</div>
  </div>

{% endblock %}

{% block js %}

<script>
	
</script>
<script src="{% static 'js/catalog.js' %} "></script>

{% endblock %}